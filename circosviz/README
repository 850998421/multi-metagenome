----- circosviz.pl ----- :

Searches for paired end (PE) reads in a given SAM file and generates overviews of where the PE reads maps to use directly in ciros. An example of the circos configuration file can be found in circosexample/etc/denovoviz.conf and example data output in circosexample/data.

To run:

perl circosviz.pl -i mygenome.mapping.sam -f mygenome.fa

The following settings can be changed:

[-samfile -i]        SAM formated mapping file
[-fastafile -f]      Fasta file of sequences used in the mapping
[-enddist -e]        Reads must hit within this distance of the end to be considered an end hit (default: 500)
[-minlength -m]      The minimum lenght of a contig to infer closed circle (default: 3000)
[-avgreadlength -a]  The average readlength of the reads used to estimate read position (default: 125)
[-headersplit -s]    The symbol used to split the header to make the read 1 and 2 headers identical (default: _)
[-circoscbin -b]     The windowlength used for the circos coverage file (default: 10000)
[-minpesplit -p]     Minimum distance between PE reads to be considered a split pe read (default: 1000)

Outputfiles:

circos.ends.txt           : Connections between PE reads mapping to ends of contigs.    
circos.dcontigs.txt       : Connections between PE reads where atleast one of the PE reads map to different contigs, but where at least one read does not map to the end of a contig.
circos.scontigs.wl.txt    : Connections between PE reads where the reads map within the same contig but not at ends and with a distance greater than the PE distance between them.
circos.karyotype.txt      : Karyotype file need for the basic layout in circos. Contigs are arranged by length and colored using a colorbrewer color scheme. 
circos.coverage.txt       : Contig coverage file that can be used to plot coverage as a data track in circos.
circos.gc.txt             : Contig gc file that can be used to plot gc as a data track in circos.
circos.rules.txt          : Rules file that can be used to color PE connections by the color of their parrent contigs.

The program expects read names to be of the following format:

X_1
X_2

Hence splitting the header by "_" results in the same read name for the paired reads.

E.g the sam file might look as:

@HD	VN:1.0	SO:unsorted
@SQ	SN:contig1	LN:11661
@PG	ID:0	PN:clcgenomicswb	VN:5.0
HWI-ST1040:48:c06lnacxx:2:1101:7493:111092_1:N:0:CAGATC	0	contig1	373	60	100M	*	0	0	CCTCGCTCAAGATACCGGCCTAGAATCCGAGTTATCGATTTGGGATGAGATGCTGACAGTATTTGACCCGCTTTTAAAAATGGAAAAAAGACTAAGAGAG	@CCFFFDFHHGHHIDIIEGHEHGEHIGIGFHGHIIGIGGHGIJJC@ACHIIIFDIGFHGAEEFDFCCDFDDDBBDCDCDDDDDCDDDDD>?CCDDDDCC@	NH:i:1
HWI-ST1040:48:c06lnacxx:2:1101:7493:111092_2:N:0:CAGATC	16	contig1	615	60	100M	*	0	0	CAGGCCTTCATTTTGACTCTTATGACTATCAAACAAAAATCCAAACGCTAAGCGGCGGGCAGAAAACAAGACTAGCCCTTGGTAAACTATTATTAACCAA	?>81C>CCDDCCC>:5>CDCADADCDDDCCDC@>EDDBFEBEECGBF=4@BIHGHEEGGHEFJHIIJIGGHHHGIIIJIJJJIHEHGHGHFDFDDDFCC@	NH:i:1